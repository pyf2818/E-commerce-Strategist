import{H as D,V,$ as g,h as $,d as n,a,g as H,b as f,D as b,f as p,x as _,J as E,N as J,A as Q,m as T,l as o,e as k,T as h}from"./index-6PeRYcw-.js";import{Q as z}from"./ModelSelector.vue_vue_type_script_setup_true_lang-BBsFU803.js";const K={class:"max-w-4xl mx-auto h-[calc(100vh-8rem)] flex flex-col"},M={class:"flex items-center justify-between mb-4"},N={class:"whitespace-pre-wrap font-sans text-sm leading-relaxed"},P={key:0,class:"flex justify-start"},S={key:0,class:"mt-4"},U={class:"flex flex-wrap gap-2"},q=["onClick"],B={class:"mt-4 flex gap-3"},F={class:"flex-1 relative"},G=["disabled"],L=["disabled"],W=D({__name:"AIAssistantView",setup(O){const y=V(),s=g([]),r=g(""),i=g(!1),u=g(null),v=async()=>{if(!r.value.trim()||i.value)return;if(!y.isConfigured){d("assistant","è¯·å…ˆåœ¨è®¾ç½®é¡µé¢é…ç½® AI APIï¼Œæ‰èƒ½ä½¿ç”¨ AI åŠ©æ‰‹åŠŸèƒ½ã€‚");return}const l=r.value.trim();r.value="",d("user",l),i.value=!0;try{const e=y.getService(),t=s.value.slice(-10).map(c=>({role:c.role,content:c.content}));let x="";const I=d("assistant",""),j=`ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ç”µå•†è¿è¥é¡¾é—®ï¼Œç²¾é€šå„å¤§ç”µå•†å¹³å°çš„è¿è¥ç­–ç•¥ã€‚
ä½ çš„ä»»åŠ¡æ˜¯å¸®åŠ©å•†å®¶è§£å†³ç”µå•†è¿è¥ä¸­é‡åˆ°çš„å„ç§é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š
- åº—é“ºè¿è¥ç­–ç•¥
- äº§å“é€‰å“å»ºè®®
- è¥é”€æ´»åŠ¨ç­–åˆ’
- æ•°æ®åˆ†æè§£è¯»
- å®¢æˆ·è¿è¥æŠ€å·§
- ç›´æ’­å¸¦è´§æŒ‡å¯¼

è¯·ç”¨ä¸“ä¸šã€å‹å–„ã€å®ç”¨çš„æ–¹å¼å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚å¦‚æœé—®é¢˜ä¸æ˜ç¡®ï¼Œå¯ä»¥é€‚å½“è¿½é—®ã€‚`;for await(const c of e.chatStream([...t,{role:"user",content:l}],j))x+=c,I.content=x,m()}catch(e){d("assistant",`æŠ±æ­‰ï¼Œå‡ºç°äº†é”™è¯¯ï¼š${e instanceof Error?e.message:"è¯·ç¨åé‡è¯•"}`)}finally{i.value=!1,m()}},d=(l,e)=>{const t={id:`msg-${Date.now()}`,role:l,content:e,timestamp:Date.now()};return s.value.push(t),t},m=()=>{T(()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)})},w=()=>{s.value=[]},A=["å¦‚ä½•æé«˜åº—é“ºè½¬åŒ–ç‡ï¼Ÿ","æ–°æ‰‹å¼€æ·˜å®åº—éœ€è¦åšä»€ä¹ˆå‡†å¤‡ï¼Ÿ","å¦‚ä½•å†™å‡ºå¸å¼•äººçš„å•†å“æ ‡é¢˜ï¼Ÿ","æŠ–éŸ³ç›´æ’­å¸¦è´§æœ‰ä»€ä¹ˆæŠ€å·§ï¼Ÿ","å¦‚ä½•åšç«å“åˆ†æï¼Ÿ"],C=l=>{r.value=l,v()};return $(()=>{s.value.length===0&&d("assistant",`ä½ å¥½ï¼æˆ‘æ˜¯ç”µå•†å†›å¸ˆ AI åŠ©æ‰‹ ğŸ¤–

æˆ‘å¯ä»¥å¸®ä½ è§£ç­”ç”µå•†è¿è¥ç›¸å…³çš„é—®é¢˜ï¼Œæ¯”å¦‚åº—é“ºè¿è¥ã€é€‰å“ç­–ç•¥ã€è¥é”€æ´»åŠ¨ã€æ•°æ®åˆ†æç­‰ã€‚

è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„ï¼Ÿ`)}),(l,e)=>(o(),n("div",K,[a("div",M,[e[1]||(e[1]=a("h2",{class:"text-xl font-bold text-gray-800 dark:text-gray-200"}," AI åŠ©æ‰‹ ",-1)),H(z,{"model-type":"text","show-label":!0,size:"md"})]),a("div",{ref_key:"messagesContainer",ref:u,class:"flex-1 overflow-y-auto space-y-4 p-4 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700"},[(o(!0),n(f,null,b(s.value,t=>(o(),n("div",{key:t.id,class:k(["flex",t.role==="user"?"justify-end":"justify-start"])},[a("div",{class:k(["max-w-[80%] rounded-2xl px-4 py-3",t.role==="user"?"bg-primary-600 text-white rounded-br-sm":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-bl-sm"])},[a("pre",N,h(t.content),1)],2)],2))),128)),i.value?(o(),n("div",P,[...e[2]||(e[2]=[a("div",{class:"bg-gray-100 dark:bg-gray-700 rounded-2xl px-4 py-3 rounded-bl-sm"},[a("span",{class:"animate-pulse text-gray-700 dark:text-gray-300"},"æ­£åœ¨æ€è€ƒä¸­...")],-1)])])):p("",!0)],512),s.value.length<=2?(o(),n("div",S,[e[3]||(e[3]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-2"}," ä½ å¯ä»¥é—®æˆ‘ï¼š ",-1)),a("div",U,[(o(),n(f,null,b(A,t=>a("button",{key:t,class:"px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full text-sm text-gray-700 dark:text-gray-300 transition-colors",onClick:x=>C(t)},h(t),9,q)),64))])])):p("",!0),a("div",B,[s.value.length>1?(o(),n("button",{key:0,class:"btn-secondary",title:"æ¸…ç©ºå¯¹è¯",onClick:w}," ğŸ—‘ï¸ ")):p("",!0),a("div",F,[_(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>r.value=t),type:"text",placeholder:"è¾“å…¥ä½ çš„é—®é¢˜...",class:"input pr-12",disabled:i.value,onKeyup:J(v,["enter"])},null,40,G),[[E,r.value]]),a("button",{disabled:!r.value.trim()||i.value||!Q(y).isConfigured,class:"absolute right-2 top-1/2 -translate-y-1/2 p-2 rounded-lg bg-primary-600 text-white disabled:opacity-50 disabled:cursor-not-allowed",onClick:v},[...e[4]||(e[4]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)])],8,L)])])]))}});export{W as default};
