import{d as I,u as j,q as B,o,c as l,b as t,f as D,F as f,r as b,h as k,t as h,j as m,v as S,x as V,z,i as T,B as g,D as $}from"./index.js";import{_ as N}from"./ModelSelector.vue_vue_type_script_setup_true_lang.js";const E={class:"max-w-4xl mx-auto h-[calc(100vh-8rem)] flex flex-col"},F={class:"flex items-center justify-between mb-4"},H={class:"whitespace-pre-wrap font-sans text-sm leading-relaxed"},K={key:0,class:"flex justify-start"},L={key:0,class:"mt-4"},P={class:"flex flex-wrap gap-2"},Q=["onClick"],U={class:"mt-4 flex gap-3"},q={class:"flex-1 relative"},G=["disabled"],J=["disabled"],X=I({__name:"AIAssistantView",setup(O){const y=j(),a=g([]),r=g(""),i=g(!1),u=g(null),p=async()=>{if(!r.value.trim()||i.value)return;if(!y.isConfigured){d("assistant","è¯·å…ˆåœ¨è®¾ç½®é¡µé¢é…ç½® AI APIï¼Œæ‰èƒ½ä½¿ç”¨ AI åŠ©æ‰‹åŠŸèƒ½ã€‚");return}const n=r.value.trim();r.value="",d("user",n),i.value=!0;try{const e=y.getService(),s=a.value.slice(-10).map(c=>({role:c.role,content:c.content}));let v="";const A=d("assistant",""),M=`ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ç”µå•†è¿è¥é¡¾é—®ï¼Œç²¾é€šå„å¤§ç”µå•†å¹³å°çš„è¿è¥ç­–ç•¥ã€‚
ä½ çš„ä»»åŠ¡æ˜¯å¸®åŠ©å•†å®¶è§£å†³ç”µå•†è¿è¥ä¸­é‡åˆ°çš„å„ç§é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š
- åº—é“ºè¿è¥ç­–ç•¥
- äº§å“é€‰å“å»ºè®®
- è¥é”€æ´»åŠ¨ç­–åˆ’
- æ•°æ®åˆ†æè§£è¯»
- å®¢æˆ·è¿è¥æŠ€å·§
- ç›´æ’­å¸¦è´§æŒ‡å¯¼

è¯·ç”¨ä¸“ä¸šã€å‹å–„ã€å®ç”¨çš„æ–¹å¼å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚å¦‚æœé—®é¢˜ä¸æ˜ç¡®ï¼Œå¯ä»¥é€‚å½“è¿½é—®ã€‚`;for await(const c of e.chatStream([...s,{role:"user",content:n}],M))v+=c,A.content=v,x()}catch(e){d("assistant",`æŠ±æ­‰ï¼Œå‡ºç°äº†é”™è¯¯ï¼š${e instanceof Error?e.message:"è¯·ç¨åé‡è¯•"}`)}finally{i.value=!1,x()}},d=(n,e)=>{const s={id:`msg-${Date.now()}`,role:n,content:e,timestamp:Date.now()};return a.value.push(s),s},x=()=>{$(()=>{u.value&&(u.value.scrollTop=u.value.scrollHeight)})},_=()=>{a.value=[]},w=["å¦‚ä½•æé«˜åº—é“ºè½¬åŒ–ç‡ï¼Ÿ","æ–°æ‰‹å¼€æ·˜å®åº—éœ€è¦åšä»€ä¹ˆå‡†å¤‡ï¼Ÿ","å¦‚ä½•å†™å‡ºå¸å¼•äººçš„å•†å“æ ‡é¢˜ï¼Ÿ","æŠ–éŸ³ç›´æ’­å¸¦è´§æœ‰ä»€ä¹ˆæŠ€å·§ï¼Ÿ","å¦‚ä½•åšç«å“åˆ†æï¼Ÿ"],C=n=>{r.value=n,p()};return B(()=>{a.value.length===0&&d("assistant",`ä½ å¥½ï¼æˆ‘æ˜¯ç”µå•†å†›å¸ˆ AI åŠ©æ‰‹ ğŸ¤–

æˆ‘å¯ä»¥å¸®ä½ è§£ç­”ç”µå•†è¿è¥ç›¸å…³çš„é—®é¢˜ï¼Œæ¯”å¦‚åº—é“ºè¿è¥ã€é€‰å“ç­–ç•¥ã€è¥é”€æ´»åŠ¨ã€æ•°æ®åˆ†æç­‰ã€‚

è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„ï¼Ÿ`)}),(n,e)=>(o(),l("div",E,[t("div",F,[e[1]||(e[1]=t("h2",{class:"text-xl font-bold text-gray-800 dark:text-gray-200"}," AI åŠ©æ‰‹ ",-1)),D(N,{"model-type":"text","show-label":!0,size:"md"})]),t("div",{ref_key:"messagesContainer",ref:u,class:"flex-1 overflow-y-auto space-y-4 p-4 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700"},[(o(!0),l(f,null,b(a.value,s=>(o(),l("div",{key:s.id,class:k(["flex",s.role==="user"?"justify-end":"justify-start"])},[t("div",{class:k(["max-w-[80%] rounded-2xl px-4 py-3",s.role==="user"?"bg-primary-600 text-white rounded-br-sm":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-bl-sm"])},[t("pre",H,h(s.content),1)],2)],2))),128)),i.value?(o(),l("div",K,[...e[2]||(e[2]=[t("div",{class:"bg-gray-100 dark:bg-gray-700 rounded-2xl px-4 py-3 rounded-bl-sm"},[t("span",{class:"animate-pulse text-gray-700 dark:text-gray-300"},"æ­£åœ¨æ€è€ƒä¸­...")],-1)])])):m("",!0)],512),a.value.length<=2?(o(),l("div",L,[e[3]||(e[3]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-2"}," ä½ å¯ä»¥é—®æˆ‘ï¼š ",-1)),t("div",P,[(o(),l(f,null,b(w,s=>t("button",{key:s,class:"px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full text-sm text-gray-700 dark:text-gray-300 transition-colors",onClick:v=>C(s)},h(s),9,Q)),64))])])):m("",!0),t("div",U,[a.value.length>1?(o(),l("button",{key:0,class:"btn-secondary",title:"æ¸…ç©ºå¯¹è¯",onClick:_}," ğŸ—‘ï¸ ")):m("",!0),t("div",q,[S(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),type:"text",placeholder:"è¾“å…¥ä½ çš„é—®é¢˜...",class:"input pr-12",disabled:i.value,onKeyup:z(p,["enter"])},null,40,G),[[V,r.value]]),t("button",{disabled:!r.value.trim()||i.value||!T(y).isConfigured,class:"absolute right-2 top-1/2 -translate-y-1/2 p-2 rounded-lg bg-primary-600 text-white disabled:opacity-50 disabled:cursor-not-allowed",onClick:p},[...e[4]||(e[4]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)])],8,J)])])]))}});export{X as default};
